import sys
sys.path.append("..")
import json
from helper import pathway


if __name__ == "__main__":
    ans = pathway.bytecode_disasm("608060405234801561001057600080fd5b50600436106100365760003560e01c80634fe242511461003b5780636cf5f8cc14610059575b600080fd5b610043610089565b604051610050919061012a565b60405180910390f35b610073600480360381019061006e91906100ee565b61008f565b604051610080919061012a565b60405180910390f35b60005481565b6000600a82106100ab57600a60008190555060005490506100d4565b60058214156100c657600560008190555060005490506100d4565b600260008190555060005490505b919050565b6000813590506100e881610154565b92915050565b6000602082840312156101045761010361014f565b5b6000610112848285016100d9565b91505092915050565b61012481610145565b82525050565b600060208201905061013f600083018461011b565b92915050565b6000819050919050565b600080fd5b61015d81610145565b811461016857600080fd5b5056fea2646970667358221220d3a03842183641eedc776e324b497a86f7acb7448b5b92c90337c8504a0bbb9364736f6c63430008070033")
    #print(ans)
    pc_tag_dict = pathway.build_jump_block("608060405234801561001057600080fd5b50600436106100365760003560e01c80634fe242511461003b5780636cf5f8cc14610059575b600080fd5b610043610089565b604051610050919061012a565b60405180910390f35b610073600480360381019061006e91906100ee565b61008f565b604051610080919061012a565b60405180910390f35b60005481565b6000600a82106100ab57600a60008190555060005490506100d4565b60058214156100c657600560008190555060005490506100d4565b600260008190555060005490505b919050565b6000813590506100e881610154565b92915050565b6000602082840312156101045761010361014f565b5b6000610112848285016100d9565b91505092915050565b61012481610145565b82525050565b600060208201905061013f600083018461011b565b92915050565b6000819050919050565b600080fd5b61015d81610145565b811461016857600080fd5b5056fea2646970667358221220d3a03842183641eedc776e324b497a86f7acb7448b5b92c90337c8504a0bbb9364736f6c63430008070033")
    print(pc_tag_dict)
    with open("jump_example_res.json", "r", encoding="utf-8") as json_f:
        json_res = json.load(json_f)
        ans_hit_count = pathway.calculate_target(pc_tag_dict, json_res)
        print(ans_hit_count)